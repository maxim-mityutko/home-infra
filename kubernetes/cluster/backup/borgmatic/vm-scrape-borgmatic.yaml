## Victoria Metrics
#---
#apiVersion: operator.victoriametrics.com/v1beta1
#kind: VMServiceScrape
#metadata:
#  labels:
#    app.kubernetes.io/instance: victoria-metrics
#  name: borgmatic-metrics
#  namespace: backup
#spec:
#  endpoints:
#    - port: health
#      path: /metrics
#      scrapeTimeout: 60s
#      #interval: 3000s
#      relabelConfigs:
#        - target_label: job
#          replacement: borgmatic
##  namespaceSelector:
##    matchNames:
##      - backup
#  selector:
#    matchLabels:
#     name: borgmatic
---
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMPodScrape
metadata:
  labels:
    app.kubernetes.io/instance: victoria-metrics
  name: borgmatic-pod-metrics
  namespace: backup
spec:
  podMetricsEndpoints:
    - port: health
      scheme: http
      path: /metrics
      interval: 60s
      relabelConfigs:
        - target_label: job
          replacement: borgmatic
  selector:
    matchLabels:
     name: borgmatic
