---
apiVersion: operator.victoriametrics.com/v1beta1
kind: VMPodScrape
metadata:
  labels:
    app.kubernetes.io/instance: victoria-metrics
  name: postgres-cnpg-metrics
  namespace: default
spec:
  podMetricsEndpoints:
    - port: metrics
      scheme: http
      scrapeTimeout: 120s
      interval: 10s
      relabelConfigs:
        - target_label: job
          replacement: postgres-cnpg-metrics
        - target_label: cluster
          replacement: postgres-cnpg
      # metricRelabelConfigs:
        # - sourceLabels: ["__name__"]
        #   regex: (apiserver_response_sizes_bucket|apiserver_watch_events_sizes_bucket)
        #   action: drop
  selector:
    matchLabels:
     cnpg.io/cluster: postgres-cnpg